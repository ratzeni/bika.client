language: python
python:
- 2.7
- 3.5
- 3.6

install:
- sudo apt-get update
- if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh
  -O miniconda.sh; else wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
  -O miniconda.sh; fi
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda update -q conda
- conda info -a
- conda create -q -n test-environment python=$TRAVIS_PYTHON_VERSION
- source activate test-environment
- pip install -r requirements.txt
- python setup.py install

script:
- make test

deploy:
  provider: pypi
  distributions: "sdist bdist_wheel"
  user: ratzeni
  password:
    secure: uw/A6puIwA3QzLcV/Zn2CNAlygkYyglsun73gyJqwH1QfvsdFX5nNB9roaQGAuKXpOmSJ8RoQkK+BZ8fzjjtFGL7Q2Xjs6r4VlIFyXuFjfqRKUMMA/lnvplUS7hUupDeZOQ9k5tZ5qFeeIrLqADAVoraHMM2HIwm8I2vJ1KRcxYv57zcN91l3KQcQc+lZmSQO1TX3UjMsk5bx3aNpFUV8vfrA72iYHmywCmJJb2o7ZHW6xzZQB9M4iJYTEuvu/Tp0zjn3gHTwGu6qkBYefCRJwJ6tJxqzd4vNE4AQZZ/lSHTsB6JAo3wfBuFwnrUrxYqSnsPazdjzk8FafVMdG+lLIKofqJCZgZ5w5Q0xLpV4M5cc+DT1LuvlTD4o1c8EL4i6f+v4Qd3XYGxA+vGWOxmUM30rVfdAv8f6GMvjVOLKg7y26IXZCrPOGbRyONZRZLZv/OW13YZbZoRsMjUn5k05bcLgmJH8dmY1qCmEOhRZLzdwHIhB+S/huSGoYAmzqq2NSe6aPJaqouKjrxevbaCLSqJ4J9lfhhc4NzlRIfdxZ2cslT4rTECLDHyhYCMvqddgbP3K83N5sql86wH3Z+PG4p/0U/DnyVCUioqIgchtI5c2XxBqUvDVKeqnwVCHED4hlp/Qfl0Co5x0AQ7YbKsfVZAEUbSwJQr0Shqf4kIS2Q=
  on:
    tags: true
    repo: gmauro/comoda
    condition: $TRAVIS_PYTHON_VERSION = "3.5"